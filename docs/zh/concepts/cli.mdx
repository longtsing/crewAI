---
title: CLI
description: 学习如何使用 CrewAI CLI 与 CrewAI 进行交互。
icon: terminal
mode: "wide"
---

<Warning>自 0.140.0 版本开始，CrewAI AOP 开始迁移其登录提供商。因此，通过 CLI 进行身份验证流程已更新。使用 Google 登录或在 2025 年 7 月 3 日之后创建账户的用户将无法使用旧版本的 `crewai` 库登录。</Warning>

## 概述

CrewAI CLI 提供了一组命令来与 CrewAI 进行交互，允许您创建、训练、运行和管理团队及流程。

## 安装

要使用 CrewAI CLI，请确保已安装 CrewAI：

```shell Terminal
pip install crewai
```

## 基本用法

CrewAI CLI 命令的基本结构是：

```shell Terminal
crewai [COMMAND] [OPTIONS] [ARGUMENTS]
```

## 可用命令

### 1. 创建

创建新的团队或流程。

```shell Terminal
crewai create [OPTIONS] TYPE NAME
```

- `TYPE`：在 "crew" 或 "flow" 之间选择
- `NAME`：团队或流程的名称

示例：
```shell Terminal
crewai create crew my_new_crew
crewai create flow my_new_flow
```

### 2. 版本

显示 CrewAI 的已安装版本。

```shell Terminal
crewai version [OPTIONS]
```

- `--tools`：（可选）显示 CrewAI 工具的已安装版本

示例：
```shell Terminal
crewai version
crewai version --tools
```

### 3. 训练

训练指定迭代次数的团队。

```shell Terminal
crewai train [OPTIONS]
```

- `-n, --n_iterations INTEGER`：训练团队的迭代次数（默认：5）
- `-f, --filename TEXT`：用于训练的自定义文件路径（默认："trained_agents_data.pkl"）

示例：
```shell Terminal
crewai train -n 10 -f my_training_data.pkl
```

### 4. 重放

从特定任务重放团队执行。

```shell Terminal
crewai replay [OPTIONS]
```

- `-t, --task_id TEXT`：从此任务 ID 重放团队，包括所有后续任务

示例：
```shell Terminal
crewai replay -t task_123456
```

### 5. 日志任务输出

获取您最新的 crew.kickoff() 任务输出。

```shell Terminal
crewai log-tasks-outputs
```

### 6. 重置记忆

重置团队记忆（长期、短期、实体、latest_crew_kickoff_outputs）。

```shell Terminal
crewai reset-memories [OPTIONS]
```

- `-l, --long`：重置长期记忆
- `-s, --short`：重置短期记忆
- `-e, --entities`：重置实体记忆
- `-k, --kickoff-outputs`：重置最新启动任务输出
- `-kn, --knowledge`：重置知识存储
- `-akn, --agent-knowledge`：重置代理知识存储
- `-a, --all`：重置所有记忆

示例：
```shell Terminal
crewai reset-memories --long --short
crewai reset-memories --all
```

### 7. 测试

测试团队并评估结果。

```shell Terminal
crewai test [OPTIONS]
```

- `-n, --n_iterations INTEGER`：测试团队的迭代次数（默认：3）
- `-m, --model TEXT`：在团队上运行测试的 LLM 模型（默认："gpt-4o-mini"）

示例：
```shell Terminal
crewai test -n 5 -m gpt-3.5-turbo
```

### 8. 运行

运行团队或流程。

```shell Terminal
crewai run
```

<Note>
从 0.103.0 版本开始，`crewai run` 命令可用于运行标准团队和流程。对于流程，它会自动从 pyproject.toml 检测类型并运行适当的命令。现在这是运行团队和流程的推荐方式。
</Note>

<Note>
确保从设置 CrewAI 项目的目录中运行这些命令。
某些命令可能需要在项目结构中进行额外的配置或设置。
</Note>

### 9. 聊天

从 `0.98.0` 版本开始，当您运行 `crewai chat` 命令时，您会启动与团队的交互式会话。AI 助手将通过询问执行团队所需的必要输入来引导您。一旦提供了所有输入，团队将执行其任务。

收到结果后，您可以继续与助手交互以获取进一步的指示或问题。

```shell Terminal
crewai chat
```
<Note>
确保在您的 CrewAI 项目的根目录中执行这些命令。
</Note>
<Note>
重要：在您的 `crew.py` 文件中设置 `chat_llm` 属性以启用此命令。

```python
@crew
def crew(self) -> Crew:
    return Crew(
        agents=self.agents,
        tasks=self.tasks,
        process=Process.sequential,
        verbose=True,
        chat_llm="gpt-4o",  # 用于聊天编排的 LLM
    )
```
</Note>

### 10. 部署

将团队或流程部署到 [CrewAI AOP](https://app.crewai.com)。

- **身份验证**：您需要通过身份验证才能部署到 CrewAI AOP。
    您可以使用以下命令登录或创建账户：
    ```shell Terminal
    crewai login
    ```

- **创建部署**：通过身份验证后，您可以从本地项目的根目录为您的团队或流程创建部署。
    ```shell Terminal
    crewai deploy create
    ```
    - 读取您的本地项目配置。
    - 提示您确认在本地找到的环境变量（如 `OPENAI_API_KEY`、`SERPER_API_KEY`）。这些将安全地存储在企业平台的部署中。确保在运行此命令前在本地正确配置敏感密钥（例如，在 `.env` 文件中）。

### 11. 组织管理

管理您的 CrewAI AOP 组织。

```shell Terminal
crewai org [COMMAND] [OPTIONS]
```

#### 命令：

- `list`：列出您所属的所有组织
```shell Terminal
crewai org list
```

- `current`：显示您当前活跃的组织
```shell Terminal
crewai org current
```

- `switch`：切换到特定组织
```shell Terminal
crewai org switch <organization_id>
```

<Note>
您必须通过身份验证到 CrewAI AOP 才能使用这些组织管理命令。
</Note>

- **创建部署**（续）：
    - 将部署链接到相应的远程 GitHub 仓库（通常会自动检测）。

- **部署团队**：通过身份验证后，您可以将团队或流程部署到 CrewAI AOP。
    ```shell Terminal
    crewai deploy push
    ```
    - 在 CrewAI AOP 平台上启动部署过程。
    - 成功启动后，它将输出"部署创建成功！"消息以及部署名称和唯一的部署 ID（UUID）。

- **部署状态**：您可以使用以下命令检查部署状态：
    ```shell Terminal
    crewai deploy status
    ```
    这会获取您最近部署尝试的最新部署状态（例如，"正在为团队构建镜像"、"部署已排队"、"在线"）。

- **部署日志**：您可以使用以下命令检查部署日志：
    ```shell Terminal
    crewai deploy logs
    ```
    这会将部署日志流式传输到您的终端。

- **列出部署**：您可以使用以下命令列出所有部署：
    ```shell Terminal
    crewai deploy list
    ```
    这会列出您的所有部署。

- **删除部署**：您可以使用以下命令删除部署：
    ```shell Terminal
    crewai deploy remove
    ```
    这会从 CrewAI AOP 平台删除部署。

- **帮助命令**：您可以使用以下命令获取 CLI 帮助：
    ```shell Terminal
    crewai deploy --help
    ```
    这会显示 CrewAI 部署 CLI 的帮助消息。

观看此视频教程，了解使用 CLI 将团队部署到 [CrewAI AOP](http://app.crewai.com) 的分步演示。

<iframe
  className="w-full aspect-video rounded-xl"
  src="https://www.youtube.com/embed/3EqSV-CYDZA"
  title="CrewAI 部署指南"
  frameBorder="0"
  allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
  allowFullScreen
></iframe>

### 11. 登录

使用安全设备码流程（无需输入电子邮件）与 CrewAI AOP 进行身份验证。

```shell Terminal
crewai login
```

发生什么：
- 终端中显示验证 URL 和短码
- 您的浏览器打开到验证 URL
- 输入/确认代码以完成身份验证

注意：
- OAuth2 提供商和域名通过 `crewai config` 配置（默认使用 `login.crewai.com`）
- 成功登录后，CLI 也会尝试自动验证到工具存储库
- 如果您重置配置，请再次运行 `crewai login` 重新验证

### 12. API 密钥

当运行 ```crewai create crew``` 命令时，CLI 将显示可用的 LLM 提供商列表供您选择，然后为您选择的提供商提供模型选择。

一旦选择了 LLM 提供商和模型，系统将提示您输入 API 密钥。

#### 可用的 LLM 提供商

以下是 CLI 建议的最受欢迎的 LLM 提供商列表：

* OpenAI
* Groq
* Anthropic
* Google Gemini
* SambaNova

当您选择提供商时，CLI 将显示该提供商的可用模型并提示您输入 API 密钥。

#### 其他选项

如果您选择"其他"，您将能够从受支持的 LiteLLM 提供商列表中选择。

当您选择提供商时，CLI 将提示您输入密钥名称和 API 密钥。

请参阅以下链接了解每个提供商的密钥名称：

* [LiteLLM 提供商](https://docs.litellm.ai/docs/providers)

### 13. 配置管理

管理 CrewAI 的 CLI 配置设置。

```shell Terminal
crewai config [COMMAND] [OPTIONS]
```

#### 命令：

- `list`：显示所有 CLI 配置参数
```shell Terminal
crewai config list
```

- `set`：设置 CLI 配置参数
```shell Terminal
crewai config set <key> <value>
```

- `reset`：将所有 CLI 配置参数重置为默认值
```shell Terminal
crewai config reset
```

#### 可用配置参数

- `enterprise_base_url`：CrewAI AOP 实例的基础 URL
- `oauth2_provider`：用于身份验证的 OAuth2 提供商（例如，workos、okta、auth0）
- `oauth2_audience`：OAuth2 受众值，通常用于识别目标 API 或资源
- `oauth2_client_id`：提供商颁发的 OAuth2 客户端 ID，在身份验证请求期间使用
- `oauth2_domain`：OAuth2 提供商的域名（例如，your-org.auth0.com），用于颁发令牌

#### 示例

显示当前配置：
```shell Terminal
crewai config list
```

示例输出：
| 设置             | 值                      | 描述                                                 |
| :-------------- | :----------------------- | :---------------------------------------------------- |
| enterprise_base_url | https://app.crewai.com   | CrewAI AOP 实例的基础 URL                  |
| org_name        | 未设置                   | 当前活跃组织的名称                             |
| org_uuid        | 未设置                   | 当前活跃组织的 UUID                             |
| oauth2_provider    | workos                   | OAuth2 提供商（例如，workos、okta、auth0）                 |
| oauth2_audience     | client_01YYY             | 识别目标 API/资源的受众                             |
| oauth2_client_id    | client_01XXX             | 提供商颁发的 OAuth2 客户端 ID                     |
| oauth2_domain       | login.crewai.com         | 提供商域名（例如，your-org.auth0.com）                  |

设置企业基础 URL：
```shell Terminal
crewai config set enterprise_base_url https://my-enterprise.crewai.com
```

设置 OAuth2 提供商：
```shell Terminal
crewai config set oauth2_provider auth0
```

设置 OAuth2 域名：
```shell Terminal
crewai config set oauth2_domain my-company.auth0.com
```

将所有配置重置为默认值：
```shell Terminal
crewai config reset
```

<Tip>
重置配置后，重新运行 `crewai login` 再次验证。
</Tip>

### 14. 跟踪管理

管理团队和流程执行的跟踪收集偏好。

```shell Terminal
crewai traces [COMMAND]
```

#### 命令：

- `enable`：为团队/流程执行启用跟踪收集
```shell Terminal
crewai traces enable
```

- `disable`：为团队/流程执行禁用跟踪收集
```shell Terminal
crewai traces disable
```

- `status`：显示当前跟踪收集状态
```shell Terminal
crewai traces status
```

#### 跟踪工作原理

跟踪收集通过按优先顺序检查三个设置来控制：

1. **代码中的显式标志**（最高优先级 - 可以启用或禁用）：
   ```python
   crew = Crew(agents=[...], tasks=[...], tracing=True)   # 总是启用
   crew = Crew(agents=[...], tasks=[...], tracing=False)  # 总是禁用
   crew = Crew(agents=[...], tasks=[...])                 # 检查较低优先级（默认）
   ```
   - `tracing=True` 将**总是启用**跟踪（覆盖所有设置）
   - `tracing=False` 将**总是禁用**跟踪（覆盖所有设置）
   - `tracing=None` 或省略将检查较低优先级设置

2. **环境变量**（第二优先级）：
   ```env
   CREWAI_TRACING_ENABLED=true
   ```
   - 仅在代码中 `tracing` 未显式设置为 `True` 或 `False` 时检查
   - 设置为 `true` 或 `1` 启用跟踪

3. **用户偏好**（最低优先级）：
   ```shell Terminal
   crewai traces enable
   ```
   - 仅在代码中未设置 `tracing` 且 `CREWAI_TRACING_ENABLED` 未设置为 `true` 时检查
   - 运行 `crewai traces enable` 足以自行启用跟踪

<Note>
**要启用跟踪**，使用以下任一方法：
- 在团队/流程代码中设置 `tracing=True`，或
- 将 `CREWAI_TRACING_ENABLED=true` 添加到您的 `.env` 文件，或
- 运行 `crewai traces enable`

**要禁用跟踪**，使用以下任一方法：
- 在团队/流程代码中设置 `tracing=False`（覆盖所有设置），或
- 删除或设置为 `false` 的 `CREWAI_TRACING_ENABLED` 环境变量，或
- 运行 `crewai traces disable`

较高优先级设置会覆盖较低设置。
</Note>

<Tip>
有关跟踪的更多信息，请参阅 [跟踪文档](/observability/tracing)。
</Tip>

<Tip>
CrewAI CLI 在向项目添加包时自动处理与工具存储库的身份验证。只需在任何 `uv` 命令前附加 `crewai` 即可使用它。例如 `crewai uv add requests`。有关更多信息，请参阅 [工具存储库](https://docs.crewai.com/enterprise/features/tool-repository) 文档。
</Tip>

<Note>
配置设置存储在 `~/.config/crewai/settings.json` 中。某些设置如组织名称和 UUID 是只读的，通过身份验证和组织命令管理。工具存储库相关设置是隐藏的，用户无法直接设置。
</Note>